# Anki共有デッキをスプレッドシートで一括編集し、自分用のデッキを作成する

Ankiの使い方の一つに、AnkiWebで共有されているデッキをインストールして学習に活用する方法がある。  
自分でデッキを作成するのは手間がかかるため、学習目的に合った共有デッキがあれば非常に便利である。

ただし、その共有デッキを編集したい場合には、通常はカードを一つひとつ手作業で編集する必要がある。  
編集する項目が少ない場合は問題ないが、カード数を減らしたり、複数のカードに共通する要素を一括で編集したりしたい場合、同じ作業を繰り返すことになり、非常に面倒である。

そこで、本稿では共有デッキをスプレッドシートで編集し、新たにデッキを作成する手順を紹介する。

## 概要

作業の概要は以下の通り。

- 共有デッキのインストール
- 形式変換ツールのインストール
- `.apkg`形式から`.csv`形式への変換
- `.csv`形式のデッキの編集
- `.csv`形式から`.apkg`形式への再変換

## 手順

### 共有デッキのインストール

[Shared Decks](https://ankiweb.net/shared/decks)から目的に合った共有デッキを検索し、ダウンロードする。

### 形式変換ツールのインストール

以下のコマンドを実行してツールをインストールする：

```bash
gem install apkg-to-csv
```

`apkg-to-csv`コマンドが使用可能な状態になっていることを確認する。  
※参考：<https://github.com/zfletch/apkg-to-csv>

### `.apkg`形式から`.csv`形式への変換

以下のコマンドを実行して、`.apkg`ファイルを`.csv`に変換する：

```bash
apkg-to-csv deck.apkg > deck.csv
```

- `deck.apkg`：ダウンロードした共有デッキのファイル名  
- `deck.csv`：出力されるCSVファイル名（必要に応じて変更）

### `.csv`形式の編集

出力された`.csv`ファイルを任意のアプリケーション（Excel、Googleスプレッドシート、Numbersなど）で開き、自由に編集する。

### `.csv`形式から`.apkg`形式への再変換

[Anki Deck Export](https://krmanik.github.io/Anki-Export-Deck-tkinter/)にアクセス  
編集済みの`.csv`ファイルをドラッグ＆ドロップまたは「BROWSE」ボタンから選択する。  
出力形式として`.apkg`を選択。  
※`Fields Separated By`の欄は **COMMA** を選択（CSV形式であるため）
